{% extends 'educa_sorriso/base.html' %}

{% block title %}Completar Perfil - EDUCA SORRISO{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow">
                <div class="card-body p-5">
                    <div class="text-center mb-4">
                        <i class="bi bi-person-plus text-primary" style="font-size: 3rem;"></i>
                        <h2 class="fw-bold mt-3">Complete seu Perfil</h2>
                        <p class="text-muted">Para continuar, precisamos de algumas informações adicionais</p>
                    </div>
                    
                    <form method="post">
                        {% csrf_token %}
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="{{ form.cpf.id_for_label }}" class="form-label">CPF *</label>
                                    {{ form.cpf }}
                                    {% if form.cpf.errors %}
                                        <div class="text-danger small">{{ form.cpf.errors.0 }}</div>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <label for="{{ form.cad_unico.id_for_label }}" class="form-label">Número do CadÚnico (opcional)</label>
                                    {{ form.cad_unico }}
                                    {% if form.cad_unico.errors %}
                                        <div class="text-danger small">{{ form.cad_unico.errors.0 }}</div>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <label for="{{ form.tipo_usuario.id_for_label }}" class="form-label">Tipo de Usuário *</label>
                                    {{ form.tipo_usuario }}
                                    {% if form.tipo_usuario.errors %}
                                        <div class="text-danger small">{{ form.tipo_usuario.errors.0 }}</div>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <label for="{{ form.data_nascimento.id_for_label }}" class="form-label">Data de Nascimento *</label>
                                    {{ form.data_nascimento }}
                                    {% if form.data_nascimento.errors %}
                                        <div class="text-danger small">{{ form.data_nascimento.errors.0 }}</div>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <label for="{{ form.telefone.id_for_label }}" class="form-label">Telefone *</label>
                                    {{ form.telefone }}
                                    {% if form.telefone.errors %}
                                        <div class="text-danger small">{{ form.telefone.errors.0 }}</div>
                                    {% endif %}
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="{{ form.cep.id_for_label }}" class="form-label">CEP *</label>
                                    {{ form.cep }}
                                    {% if form.cep.errors %}
                                        <div class="text-danger small">{{ form.cep.errors.0 }}</div>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <label for="{{ form.endereco.id_for_label }}" class="form-label">Endereço *</label>
                                    {{ form.endereco }}
                                    {% if form.endereco.errors %}
                                        <div class="text-danger small">{{ form.endereco.errors.0 }}</div>
                                    {% endif %}
                                </div>
                                
                                <div class="mb-3">
                                    <label for="{{ form.bairro.id_for_label }}" class="form-label">Bairro *</label>
                                    {{ form.bairro }}
                                    {% if form.bairro.errors %}
                                        <div class="text-danger small">{{ form.bairro.errors.0 }}</div>
                                    {% endif %}
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-8">
                                        <div class="mb-3">
                                            <label for="{{ form.cidade.id_for_label }}" class="form-label">Cidade *</label>
                                            {{ form.cidade }}
                                            {% if form.cidade.errors %}
                                                <div class="text-danger small">{{ form.cidade.errors.0 }}</div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label for="{{ form.estado.id_for_label }}" class="form-label">Estado *</label>
                                            {{ form.estado }}
                                            {% if form.estado.errors %}
                                                <div class="text-danger small">{{ form.estado.errors.0 }}</div>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center mt-4">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="bi bi-check-circle me-2"></i>Completar Perfil
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Máscaras para os campos
document.getElementById('{{ form.cpf.id_for_label }}').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length <= 11) {
        value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
        e.target.value = value;
    }
});

document.getElementById('{{ form.cep.id_for_label }}').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length <= 8) {
        value = value.replace(/(\d{5})(\d{3})/, '$1-$2');
        e.target.value = value;
    }
});

document.getElementById('{{ form.telefone.id_for_label }}').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length <= 11) {
        if (value.length <= 10) {
            value = value.replace(/(\d{2})(\d{4})(\d{4})/, '($1) $2-$3');
        } else {
            value = value.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
        }
        e.target.value = value;
    }
});
</script>
{% endblock %}
